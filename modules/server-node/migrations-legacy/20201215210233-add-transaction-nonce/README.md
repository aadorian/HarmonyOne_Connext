# Migration `20201215210233-add-transaction-nonce`

This migration has been generated by LayneHaber at 12/15/2020, 2:02:33 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "transfer" ADD COLUMN     "channelNonce" INTEGER NOT NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201118004412-defund-array..20201215210233-add-transaction-nonce
--- datamodel.dml
+++ datamodel.dml
@@ -1,13 +1,12 @@
 generator client {
-  provider        = "prisma-client-js"
-  previewFeatures = ["connectOrCreate"]
-  binaryTargets   = ["native"]
+  provider      = "prisma-client-js"
+  binaryTargets = ["native"]
 }
 datasource db {
   provider = ["postgresql", "sqlite"]
-  url = "***"
+  url = "***"
 }
 model Balance {
   participant      String
@@ -23,24 +22,24 @@
   @@map(name: "balance")
 }
 model Channel {
-  channelAddress           String    @id
-  publicIdentifierA        String
-  publicIdentifierB        String
-  participantA             String
-  participantB             String
-  assetIds                 String
-  timeout                  String
-  nonce                    Int
-  merkleRoot               String
-  balances                 Balance[]
-  channelFactoryAddress    String
-  transferRegistryAddress  String
-  chainId                  String
-  providerUrl              String
-  latestUpdate             Update?
-  inDispute                Boolean
+  channelAddress          String    @id
+  publicIdentifierA       String
+  publicIdentifierB       String
+  participantA            String
+  participantB            String
+  assetIds                String
+  timeout                 String
+  nonce                   Int
+  merkleRoot              String
+  balances                Balance[]
+  channelFactoryAddress   String
+  transferRegistryAddress String
+  chainId                 String
+  providerUrl             String
+  latestUpdate            Update?
+  inDispute               Boolean
   activeTransfers Transfer[]
   OnchainTransaction OnchainTransaction[]
@@ -72,9 +71,9 @@
   // DETAILS
   // deposit details
   totalDepositsAlice String?
-  totalDepositsBob String?
+  totalDepositsBob   String?
   // create details
   transferAmountA      String?
   transferAmountB      String?
@@ -102,11 +101,12 @@
   @@map(name: "update")
 }
 model Transfer {
-  transferId String @id
-  routingId  String
-  inDispute  Boolean
+  transferId    String @id
+  routingId     String
+  inDispute     Boolean
+  channelNonce  Int
   createUpdate  Update? @relation(name: "CreatedTransfer", fields: [createUpdateChannelAddressId, createUpdateNonce], references: [channelAddressId, nonce])
   resolveUpdate Update? @relation(name: "ResolvedTransfer", fields: [resolveUpdateChannelAddressId, resolveUpdateNonce], references: [channelAddressId, nonce])
```


